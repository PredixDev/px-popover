<!doctype html>

<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>px-popover Test Suite</title>

        <script>
          // Setup Polymer options
          window.Polymer = {
            dom: 'shadow',
            lazyRegister: true,
          };
        </script>

        <script src="../bower_components/webcomponentsjs/webcomponents-lite.min.js"></script>
        <!-- web-component-tester automatically provides local copy of brower.js below
             for any URL ending with "/web-component-tester/browser.js"
             when wct is run from the command line -->
        <script src="../web-component-tester/browser.js"></script>
        <!-- Import custom element. Note: see comment about relative paths to dependencies in the *.html file referenced below -->
        <link rel="import" href="../../px-theme/px-theme-styles.html"/>
        <style include="px-theme-styles" is="custom-style"></style>
        <link rel="import" href="../px-popover.html"/>
        <style media="screen">
            .sample-container {
                width: 250px;
                margin-left: auto;
                margin-right: auto;
            }
            .hover-popover {
                padding: 15px;
                width: 200px;
                background-color: black;
                color: white;
                text-align: center;
                vertical-align: middle;
            }
            html,body{
              position:static !important
            }
        </style>
    </head>

    <body>

        <p>
            Click button to invoke popover:
        </p>

        <div class="sample-container">

            <button id="btnEnhanced" type="button" name="button">Enhanced</button>
            <px-popover
                id="testPopoverEnhanced"
                enhanced
                for="btnEnhanced"
                orientation="bottom"
                >

                <div>This is a form
                  <form><input class='text-input' type='text' value='Input'></form>
                </div>
            </px-popover>
        </div>
        <p></p>

        <script>
            suite('<px-popover>', function() {

                test('popover stays open after click inside', function() {
                    document.querySelector('#btnEnhanced').click();
                    var wrapper = document.querySelector('#testPopoverEnhanced').$.popover__wrapper;
                    var input = Polymer.dom(wrapper.root).querySelector('input')
                    expect(wrapper.classList.contains('fadeFromHidden')).to.equal(true);
                    input.click();
                    expect(wrapper.classList.contains('fadeFromHidden')).to.equal(true);
                    wrapper.click();
                    expect(wrapper.classList.contains('fadeFromHidden')).to.equal(false);
                });

                // test('top popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUp').click();
                //       var margin = 5;
                //       var popTop = document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().bottom;
                //       var btnTop = document.querySelector('#btnUp').getBoundingClientRect().top - margin;
                //       assert.closeTo(btnTop, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUp').click();
                //       done();
                //     });
                // });
                //
                // test('top popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUp').click();
                //       var popTop = document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().width/2;
                //       var btnTop = document.querySelector('#btnUp').getBoundingClientRect().left + document.querySelector('#btnUp').getBoundingClientRect().width/2;
                //       assert.closeTo(btnTop, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUp').click();
                //       done();
                //     });
                // });
                //
                // test('top carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUp').click();
                //       var popTop = document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().bottom - document.querySelector('#testPopoverUp #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverUp #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverUp #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUp').click();
                //       done();
                //     });
                // });
                //
                // test('top carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUp').click();
                //       var popTop = document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverUp #popoverWrapper').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverUp #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverUp #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUp').click();
                //       done();
                //     });
                // });
                //
                // test('bottom popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDown').click();
                //       var margin = 5;
                //       var popDown = document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().top;
                //       var btnDown = document.querySelector('#btnDown').getBoundingClientRect().bottom + margin;
                //       assert.closeTo(btnDown, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDown').click();
                //       done();
                //     });
                // });
                //
                // test('bottom popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDown').click();
                //       var popDown = document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().width/2;
                //       var btnDown = document.querySelector('#btnDown').getBoundingClientRect().left + document.querySelector('#btnDown').getBoundingClientRect().width/2;
                //       assert.closeTo(btnDown, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDown').click();
                //       done();
                //     });
                // });
                //
                // test('bottom carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDown').click();
                //       var popDown = document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverDown #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverDown #popoverWrapper #carat').getBoundingClientRect().bottom -  document.querySelector('#testPopoverDown #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDown').click();
                //       done();
                //     });
                // });
                //
                // test('bottom carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDown').click();
                //       var popDown = document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverDown #popoverWrapper').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverDown #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverDown #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDown').click();
                //       done();
                //     });
                // });
                //
                // test('left popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeft').click();
                //       var popLeft = document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().height/2;
                //       var btnLeft = document.querySelector('#btnLeft').getBoundingClientRect().top + document.querySelector('#btnLeft').getBoundingClientRect().height/2;
                //       assert.closeTo(btnLeft, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeft').click();
                //       done();
                //     });
                // });
                //
                // test('left popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeft').click();
                //       var margin = 5;
                //       var popLeft = document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().right + margin;
                //       var btnLeft = document.querySelector('#btnLeft').getBoundingClientRect().left;
                //       assert.closeTo(btnLeft, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeft').click();
                //       done();
                //     });
                // });
                //
                // test('left carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeft').click();
                //       var popLeft = document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverLeft #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverLeft #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeft').click();
                //       done();
                //     });
                // });
                //
                // test('left carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeft').click();
                //       var popLeft = document.querySelector('#testPopoverLeft #popoverWrapper').getBoundingClientRect().right - document.querySelector('#testPopoverLeft #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverLeft #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverLeft #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeft').click();
                //       done();
                //     });
                // });
                //
                // test('right popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRight').click();
                //       var popRight = document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().height/2;
                //       var btnRight = document.querySelector('#btnRight').getBoundingClientRect().top + document.querySelector('#btnRight').getBoundingClientRect().height/2;
                //       assert.closeTo(btnRight, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRight').click();
                //       done();
                //     });
                // });
                //
                // test('right popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRight').click();
                //       var margin = 5;
                //       var popRight = document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().left - margin;
                //       var btnRight = document.querySelector('#btnRight').getBoundingClientRect().right;
                //       assert.closeTo(btnRight, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRight').click();
                //       done();
                //     });
                // });
                //
                // test('right carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRight').click();
                //       var popRight = document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverRight #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverRight #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRight').click();
                //       done();
                //     });
                // });
                //
                // test('right carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRight').click();
                //       var popRight = document.querySelector('#testPopoverRight #popoverWrapper').getBoundingClientRect().left - document.querySelector('#testPopoverRight #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverRight #popoverWrapper #carat').getBoundingClientRect().left - document.querySelector('#testPopoverRight #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRight').click();
                //       done();
                //     });
                // });
                //
                // test('relative top popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUpRel').click();
                //       var margin = 5;
                //       var popTop = document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().bottom;
                //       var btnTop = document.querySelector('#btnUpRel').getBoundingClientRect().top - margin;
                //       assert.closeTo(btnTop, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUpRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative top popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUpRel').click();
                //       var popTop = document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().width/2;
                //       var btnTop = document.querySelector('#btnUpRel').getBoundingClientRect().left + document.querySelector('#btnUpRel').getBoundingClientRect().width/2;
                //       assert.closeTo(btnTop, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUpRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative top carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUpRel').click();
                //       var popTop = document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().bottom - document.querySelector('#testPopoverUpRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverUpRel #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverUpRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUpRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative top carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnUpRel').click();
                //       var popTop = document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverUpRel #popoverWrapper').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverUpRel #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverUpRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popTop, 1, 'numbers are close');
                //       document.querySelector('#btnUpRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative bottom popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDownRel').click();
                //       var margin = 5;
                //       var popDown = document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().top;
                //       var btnDown = document.querySelector('#btnDownRel').getBoundingClientRect().bottom + margin;
                //       assert.closeTo(btnDown, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDownRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative bottom popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDownRel').click();
                //       var popDown = document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().width/2;
                //       var btnDown = document.querySelector('#btnDownRel').getBoundingClientRect().left + document.querySelector('#btnDownRel').getBoundingClientRect().width/2;
                //       assert.closeTo(btnDown, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDownRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative bottom carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDownRel').click();
                //       var popDown = document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverDownRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverDownRel #popoverWrapper #carat').getBoundingClientRect().bottom -  document.querySelector('#testPopoverDownRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDownRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative bottom carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnDownRel').click();
                //       var popDown = document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().left + document.querySelector('#testPopoverDownRel #popoverWrapper').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverDownRel #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverDownRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popDown, 1, 'numbers are close');
                //       document.querySelector('#btnDownRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative left popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeftRel').click();
                //       var popLeft = document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().height/2;
                //       var btnLeft = document.querySelector('#btnLeftRel').getBoundingClientRect().top + document.querySelector('#btnLeftRel').getBoundingClientRect().height/2;
                //       assert.closeTo(btnLeft, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeftRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative left popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeftRel').click();
                //       var margin = 5;
                //       var popLeft = document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().right + margin;
                //       var btnLeft = document.querySelector('#btnLeftRel').getBoundingClientRect().left;
                //       assert.closeTo(btnLeft, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeftRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative left carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeftRel').click();
                //       var popLeft = document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverLeftRel #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverLeftRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeftRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative left carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnLeftRel').click();
                //       var popLeft = document.querySelector('#testPopoverLeftRel #popoverWrapper').getBoundingClientRect().right - document.querySelector('#testPopoverLeftRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverLeftRel #popoverWrapper #carat').getBoundingClientRect().left + document.querySelector('#testPopoverLeftRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popLeft, 1, 'numbers are close');
                //       document.querySelector('#btnLeftRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative right popover has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRightRel').click();
                //       var popRight = document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().height/2;
                //       var btnRight = document.querySelector('#btnRightRel').getBoundingClientRect().top + document.querySelector('#btnRightRel').getBoundingClientRect().height/2;
                //       assert.closeTo(btnRight, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRightRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative right popover has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRightRel').click();
                //       var margin = 5;
                //       var popRight = document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().left - margin;
                //       var btnRight = document.querySelector('#btnRightRel').getBoundingClientRect().right;
                //       assert.closeTo(btnRight, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRightRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative right carat has correct vertical position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRightRel').click();
                //       var popRight = document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().top + document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().height/2;
                //       var carat = document.querySelector('#testPopoverRightRel #popoverWrapper #carat').getBoundingClientRect().top +  document.querySelector('#testPopoverRightRel #popoverWrapper #carat').getBoundingClientRect().height/2;
                //       assert.closeTo(carat, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRightRel').click();
                //       done();
                //     });
                // });
                //
                // test('relative right carat has correct horizontal position', function(done) {
                //     flush(function() {
                //       document.querySelector('#btnRightRel').click();
                //       var popRight = document.querySelector('#testPopoverRightRel #popoverWrapper').getBoundingClientRect().left - document.querySelector('#testPopoverRightRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       var carat = document.querySelector('#testPopoverRightRel #popoverWrapper #carat').getBoundingClientRect().left - document.querySelector('#testPopoverRightRel #popoverWrapper #carat').getBoundingClientRect().width/2;
                //       assert.closeTo(carat, popRight, 1, 'numbers are close');
                //       document.querySelector('#btnRightRel').click();
                //       done();
                //     });
                // });
            });
      </script>
    </body>
</html>
